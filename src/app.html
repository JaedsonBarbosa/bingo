<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="assets/logo.png" />
    <title>Voice Bingo</title>

    <link rel="stylesheet" href="style/global.scss" />
    <link rel="stylesheet" href="style/webapp.css" />
    <script type="module" src="code/app.ts"></script>
  </head>
  <body>
    <header class="container">
      <h3>Voice Bingo</h3>
    </header>
    <main class="container" x-data="webapp">
      <p>
        Logado no momento com o número
        <span x-text="telefone"></span>
        .
      </p>
      <!-- Eh, seria interessante usar uma ferramenta de template -->
      <!-- O PUG talvez fosse bem útil para simplificar tudo por aqui -->
      <button class="button-outline" @click="encerrarSessao">
        Encerrar sessão
      </button>
      <a href="adm.html">Acessar painel administrativo</a>

      <div x-show="jogo">
        <hr />
        <h5>Jogo</h5>
        <div x-show="cartela">
          <p>
            Números chamados:
            <em x-text="ultimosNumeros"></em>
          </p>
          <p aria-live="assertive">
            Último número:
            <em x-text="ultimoNumero"></em>
          </p>
          <table>
            <thead>
              <tr>
                <th scope="col">B</th>
                <th scope="col">I</th>
                <th scope="col">N</th>
                <th scope="col">G</th>
                <th scope="col">O</th>
              </tr>
            </thead>
            <tbody>
              <template x-for="l in linhasCartela">
                <tr>
                  <template x-for="c in l">
                    <td
                      x-data="{ marcado: false, comum: c != -1, get texto() { return `${c} ${this.marcado ? 'Sim' : 'Não'}` } }"
                      :class="{ 'marcado': marcado, 'comum': comum }"
                      @click="marcado = ! marcado"
                      :aria-label="texto"
                    >
                      <template x-if="comum">
                        <span x-show="comum" x-text="c"></span>
                      </template>
                      <template x-if="! comum">
                        <img
                          src="assets/logo.png"
                          title="Simbolo"
                          aria-label="Logotipo"
                        />
                      </template>
                    </td>
                  </template>
                </tr>
              </template>
            </tbody>
          </table>
          <button @click="bingo">BINGO</button>
        </div>
        <div x-show="! cartela">
          <div x-show="jogo?.numeros.length">
            <p>
              Um jogo está em execução neste momento, mas você não está
              participando.
            </p>
          </div>
          <div x-show="! jogo?.numeros.length">
            <p>
              Um jogo está prester a começar, se desejas participar, basta
              clicar no botão abaixo.
            </p>
            <button @click="participar">Participar</button>
          </div>
        </div>
      </div>

      <div x-show="jogos.length">
        <hr />
        <h5>Histórico de jogos</h5>
        <template x-for="j in jogos">
          <details>
            <summary x-text="j.titulo"></summary>
            <p>
              Ganhador:
              <span x-text="j.ganhador.nome"></span>
            </p>
          </details>
        </template>
      </div>
    </main>
  </body>
</html>
