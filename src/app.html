<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="assets/logo.jpg" />
    <title>Voice Bingo</title>

    <link rel="stylesheet" href="style/global.scss" />
    <link rel="stylesheet" href="style/webapp.css" />
    <script type="module" src="code/app.ts"></script>
  </head>
  <body x-data="webapp">
    <include src="modules/header.html"></include>
    <main class="container" x-cloak>
      <div x-show="jogo">
        <hr />
        <h5>Jogo</h5>
        <div x-show="cartela">
          <p>
            Números chamados:
            <em
              x-data="{ get numeros() { return jogo?.numeros.join(', ') } }"
              x-text="numeros ? numeros : 'Aguardando...'"
            ></em>
          </p>
          <p aria-live="assertive">
            Último número:
            <em x-text="jogo?.numeros[0] ?? 'Aguardando...'"></em>
          </p>
          <table>
            <thead>
              <tr>
                <th scope="col">B</th>
                <th scope="col">I</th>
                <th scope="col">N</th>
                <th scope="col">G</th>
                <th scope="col">O</th>
              </tr>
            </thead>
            <tbody>
              <template x-for="l in cartela?.linhas ?? []">
                <tr>
                  <template x-for="c in l">
                    <td
                      x-data="{ marcado: false, comum: c != -1, get texto() { return `${c} ${this.marcado ? 'Sim' : 'Não'}` } }"
                      :class="{ 'marcado': marcado, 'comum': comum }"
                      @click="marcado = ! marcado"
                      :aria-label="texto"
                    >
                      <template x-if="comum">
                        <span x-show="comum" x-text="c"></span>
                      </template>
                      <template x-if="! comum">
                        <img
                          src="assets/logo.jpg"
                          title="Uma cartela de bingo, com o símbolo de acessibilidade no centro."
                          aria-label="Logotipo"
                        />
                      </template>
                    </td>
                  </template>
                </tr>
              </template>
            </tbody>
          </table>
          <button @click="bingo">BINGO</button>
        </div>
        <div x-show="! cartela">
          <div x-show="jogo?.numeros.length">
            <p>
              Um jogo está em execução neste momento, mas você não está
              participando.
            </p>
          </div>
          <div x-show="! jogo?.numeros.length">
            <p>
              Um jogo está prester a começar, se desejas participar, basta
              clicar no botão abaixo.
            </p>
            <button @click="participar">Participar</button>
          </div>
        </div>
      </div>

      <div x-show="jogos.length">
        <hr />
        <h5>Histórico de jogos</h5>
        <template x-for="j in jogos">
          <details>
            <summary x-text="j.titulo"></summary>
            <p>
              Ganhador:
              <span x-text="j.ganhador.nome"></span>
            </p>
          </details>
        </template>
      </div>
    </main>
  </body>
</html>
